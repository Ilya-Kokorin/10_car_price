# Определение стоимости автомобиля
Необходимо построить модель, которая рассчитывает рыночную стоимость автомобиля.
Важные критерии:
<br>- качество предсказания;
<br>- время обучения модели;
<br>- время предсказания модели.

<br>Источник данных - датасет с жильем. В рамках проекта выполнена обработка пропусков и аномалий, подготовка выборок для обучения, обучение разных моделей, проанализировано время обучения, время предсказания и качество моделей, лучшая модель использовалась для тестовой выборки.

<br>Краткий вывод: наиболее распространенные типы кузова это sedan, small, и wagon. Большинство автомобилей имеют ручную коробку передач, ездят на бензине и не были в ремонте. Small, sedan и wagon имеют довольно низкие цены, чем и объясняется их широкое распространение. В тоже время suv имеет самую высокую цену и при этом таких автомобилей менее всего (исключая other). Самая большая выручка у немецких производителей: volkswagen, bmw, audi, opel и mercedes_benz. А самые надежные марки это mini, smart и porsche, что отчасти обясняет высокую цену на mini и porsche.
<br>В результате выполненных сокращений осталось примерно 85,6% от изначального количества данных. Для сравнения были использованы 4 модели: LinearRegression, RandomForestRegressor, LightGBMRegressor и CatBoostRegressor. В результате обучения моделей выяснилось, что наиболее быстрая и наименее точная модель - линейная регрессия. Она не укладывается в необходимые 2500 очков RMSE. Линейная регрессия в некоторых случаях дает отрицательную стоимость автомобиля. Также она лучше подойдет для предсказания признака, который распределен нормально. LGBM с параметрами: n_estimators = 1500, max_depth = 15 наиболее точная модель (RMSE = 1530,8) и довольно быстрая. CatBoost с параметром max_depth = 13 практически не уступает LGBM в точности (RMSE = 1531,6) но значительно медленнее. RandomForestRegressor хуже (RMSE = 1650,5) и медленне, чем LGBM, но быстрее, чем CatBoost. Для RandomForestRegressor, LGBM и CatBoost самые влиятельные признаки это год регистрации, мощность, пробег и почтовый индекс.
<br>Интересно, что LGBM и CatBoost как и линейная регрессия иногда дает отрицательную цену автомобиля. Замена значения отрицательных предсказаний на 50 евро (нижняя граница возможной стоимости в принятом датасете) почти не улучшает метрику (RMSE у обоих моделей уменьшилась примерно на 1). Это потому что всего 120 и 140 автомобилей, которым LGBM и CatBoost предсказывает отрицательную цену. У CatBoost отрицательных предсказаний больше, поэтому прирост от их замены немного выше.
<br>Также в ходе работы выяснилось, что RandomForestRegressor оказалась ближе к истиной стоимости в 44% случаев, но при этом общий результат этой модели хуже, чем у LGBM и CatBoost. Скорее всего это связано с тем, что LGBM и особенно CatBoost лучше умеют работать с выбросами.

<br>**Рекомендации:** необходимо более корректно заполнять данные (особенно год регистрации, мощность, пробег и почтовый индекс), поскольку в представленном датасете много ошибок, например нулевой месяц у месяца регистрации. Также много неестественных значений в колонках с ценой, годом регистрации, мощностью.
